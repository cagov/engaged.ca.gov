<script>

let current_theme_index = 1;

function switch_theme(theme_number) {
  // Update current theme index
  current_theme_index = parseInt(theme_number, 10);
  
  // Remove 'active' class from all theme content sections
  document.querySelectorAll('.theme-content').forEach(function(content) {
    content.classList.remove('active');
  });
  
  // Add 'active' class to the selected theme content section
  let selected_content = document.getElementById(`theme-${theme_number}-content`);
  if (selected_content) {
    selected_content.classList.add('active');
    
    // Smooth scroll to the theme content section
    selected_content.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
  
  // Update SVG circle highlighting
  document.querySelectorAll('.theme-circle').forEach(function(group) {
    let circle = group.querySelector('circle');
    let theme_num = parseInt(group.dataset.theme, 10);
    
    if (circle) {
      if (theme_num === theme_number) {
        // Highlight selected circle
        circle.style.opacity = '1';
        circle.style.stroke = 'none';
        circle.style.strokeWidth = '0';
        group.setAttribute('aria-selected', 'true');
      } else {
        // Reset to original state
        let fillColor = circle.getAttribute('fill');
        if (fillColor === '#5489A3') {
          circle.style.opacity = '0.8';
        } else if (fillColor === '#7BA8BC') {
          circle.style.opacity = '0.75';
        } else {
          circle.style.opacity = '0.7';
        }
        circle.style.stroke = 'none';
        circle.style.strokeWidth = '0';
        group.setAttribute('aria-selected', 'false');
      }
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  // Set up event handlers for clicks on theme circles in SVG
  document.querySelectorAll('.theme-circle').forEach(function(circleGroup) {
    // Make the group focusable for accessibility
    circleGroup.setAttribute('tabindex', '0');
    circleGroup.setAttribute('role', 'button');
    let themeTitle = circleGroup.querySelector('text tspan')?.textContent || 'Theme ' + circleGroup.dataset.theme;
    circleGroup.setAttribute('aria-label', 'View ' + themeTitle);
    
    // Add click handler
    circleGroup.addEventListener('click', function() {
      let theme_number = parseInt(this.dataset.theme, 10);
      switch_theme(theme_number);
    });
    
    // Add keyboard support
    circleGroup.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        let theme_number = parseInt(this.dataset.theme, 10);
        switch_theme(theme_number);
      }
    });
    
    // Add hover effect - just change opacity, no border
    let circle = circleGroup.querySelector('circle');
    circleGroup.addEventListener('mouseenter', function() {
      let theme_num = parseInt(this.dataset.theme, 10);
      if (circle && current_theme_index !== theme_num) {
        circle.style.opacity = '1';
      }
    });
    circleGroup.addEventListener('mouseleave', function() {
      let theme_num = parseInt(this.dataset.theme, 10);
      if (circle && current_theme_index !== theme_num) {
        // Reset to original opacity
        let fillColor = circle.getAttribute('fill');
        if (fillColor === '#5489A3') {
          circle.style.opacity = '0.8';
        } else if (fillColor === '#7BA8BC') {
          circle.style.opacity = '0.75';
        } else {
          circle.style.opacity = '0.7';
        }
      }
    });
  });
  
  // Handle hash navigation (e.g., #theme-3-content)
  window.addEventListener('hashchange', function() {
    let hash = window.location.hash;
    let match = hash.match(/^#theme-(\d+)-content$/);
    if (match) {
      let theme_number = parseInt(match[1], 10);
      if (theme_number >= 1 && theme_number <= 10) {
        switch_theme(theme_number);
      }
    }
  });
  
  // Check for initial hash on page load
  if (window.location.hash) {
    let hash = window.location.hash;
    let match = hash.match(/^#theme-(\d+)-content$/);
    if (match) {
      let theme_number = parseInt(match[1], 10);
      if (theme_number >= 1 && theme_number <= 10) {
        switch_theme(theme_number);
      }
    }
  }
  
  // Initialize first theme as active
  switch_theme(1);
});

</script>
